<p style="color: green"><%= notice %></p>

<%= render @profile %>

<div>
  <% if current_user == @profile.user %>
    <%= link_to "Edit account", edit_user_registration_path, method: :get %>
    <%= link_to "Edit profile", edit_profile_path(@profile) %> |
    <%= link_to "Meus grupos", groups_user_path(current_user) %>
  <% end %>
  <% if user_signed_in? && current_user.type != "BusinessUser" %>
    <%= link_to "É uma empresa? Cadastre-se aqui", new_business_registration_path, class: "btn btn-outline-primary" %>
  <% elsif user_signed_in? && current_user.type == "BusinessUser" && current_user.try(:business).present? %>
    <%= link_to "Editar perfil empresarial", edit_business_registration_path, class: "btn btn-outline-primary" %>
  <% end %>
  <div>
</div>

<!-- CORREÇÃO: Mostrar posts para QUALQUER usuário, não apenas o dono -->
<div class="max-w-5xl w-full grid gap-8 mt-8">
  <% if @posts.any? %>
    <h3>Posts de <%= @profile.user.username %></h3>
    <%= render partial: "posts/post", collection: @posts %>
  <% else %>
    <p class="text-muted">Nenhum post ainda.</p>
  <% end %>
</div>

<!-- CORREÇÃO: Botão de criar post APENAS para o dono do perfil -->
<% if current_user == @profile.user %>
  <div class="mt-6 max-w-2xl w-full mx-auto flex items-center justify-between">
    <%= link_to "Create new post", new_post_path %>
  </div>
<% end %>
