<div class="mt-4 bg-white p-4 rounded shadow">
  <h3 class="text-lg font-semibold mb-2">Comentários</h3>
  <% if @business_comments.any? %>
    <ul class="space-y-3 mb-4">
      <% @business_comments.each do |c| %>
        <li class="border rounded p-3">
          <p class="text-sm text-gray-600">Por: <%= c.user.email %> — <span class="font-semibold"><%= c.role.capitalize %></span> • <%= l(c.created_at, format: :short) %></p>
          <div class="mt-2"><%= c.body.to_s.html_safe %></div>
          <% if c.user == current_user || current_user == @business.user %>
            <%= button_to "Remover", business_business_comment_path(@business, c), method: :delete, data: { confirm: "Confirma remoção?" }, class: "text-red-600 mt-2", form: { data: { turbo_frame: "business_comments_#{@business.id}" } } %>
          <% end %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p class="text-gray-500 mb-4">Ainda não há comentários.</p>
  <% end %>

  <% if user_signed_in? %>
    <%= form_with model: [@business, BusinessComment.new], data: { turbo_frame: "business_comments_#{@business.id}" } do |f| %>
      <div class="mb-2">
        <%= f.rich_text_area :body %>
      </div>
      <div>
        <%= f.submit "Adicionar comentário", class: "bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded" %>
      </div>
    <% end %>
  <% else %>
    <p class="text-gray-500">Faça login para adicionar um comentário.</p>
  <% end %>
</div>
